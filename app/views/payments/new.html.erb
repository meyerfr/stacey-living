<div class="three-steps-navbar">
  <div class="go-back-button">
    <p>< Go Back</p>
  </div>
  <div class="three-steps-container">
    <div class="ring">
      <p>1</p>
    </div>
    <div class="line"></div>
    <div class="ring">
      <p>2</p>
    </div>
    <div class="line"></div>
    <div class="ring active">
      <p>3</p>
    </div>
  </div>
  <div class="phone">
    <%= link_to 'Call us on +49 40 606389600', "tel: +4940606389600" %>
  </div>
</div>
<div class="payment-wrapper">
  <div class="payment-container">
    <div class="payment-fields">
      <div class="header">
        <h3>Secure A Room</h3>
      </div>
      <div class="payment-section">
        <div class="form-section">
          <h2 class="payment-sections-header">Personal information</h2>
          <%= simple_form_for @applicant, method: :patch, url: update_applicant_payment_path(@booking) do |f| %>
            <%= f.input :first_name, required: false %>
            <%= f.input :last_name, required: false %>
            <%= f.input :email, required: false %>
            <%= f.label :phone, 'Mobile Number' %>
            <div class="phone">
              <%= f.input :phone_code, required: false, label: false, collection: @phone_code %>
              <%= f.input :phone, required: false, label: false %>
            </div>
            <%= f.label :gender, 'What is your Gender?', id: 'gender-label' %>
            <div class="gender">
              <%= f.collection_check_boxes :gender, [['Male'], ['Female'], ['Other']], :first, :first, required: false %>
            </div>
            <%= f.input :date_of_birth, as: :date, order: [:day, :month, :year], required: false, class: 'date' %>
            <%= f.submit 'Update User', id: 'update-user-button', class: 'hidden'%>
          <% end %>
        </div>
      </div>
      <div class="stripe-section payment-section">
        <div class="d-flex align-items-center">
          <h2 class="payment-sections-header">Payment Details</h2>
          <div class="secure-payment-wrapper">
            <div class="secure-payment-header">
              <i class="fas fa-lock"></i>
              <p>SecurePayment</p>
            </div>
            <div class="icons">
              <i class="fab fa-cc-amex"></i>
              <i class="fab fa-cc-visa"></i>
              <i class="fab fa-cc-mastercard"></i>
            </div>
          </div>
        </div>
        <%= form_tag booking_payments_path(@booking), id: 'payment-form' do |f| %>
          <div class="form-row">
            <label for="iban-element">
              IBAN
            </label>
            <div id="iban-element">
              <!-- A Stripe Element will be inserted here. -->
            </div>
          </div>
          <div id="bank-name"></div>


          <!-- Used to display form errors. -->
          <div id="error-message" role="alert"></div>

          <!-- Display mandate acceptance text. -->
          <div id="mandate-acceptance">
            By providing your IBAN and confirming this payment, you are authorizing STACEY Real Estate UG and Stripe, our payment service provider, to send instructions to your bank to debit your account and your bank to debit your account in accordance with those instructions. You are entitled to a refund from your bank under the terms and conditions of your agreement with your bank. A refund must be claimed within 8 weeks starting from the date on which your account was debited.
          </div>
          <div class="terms-and-conditions">
            <%= check_box "TermsConditions", "terms-and-conditions", id: 'terms-and-conditions' %>
            <p class="terms-and-conditions-label">I have read and agree to the terms and conditions</p>
          </div>
          <div class="privacy-policy">
            <p>By completing the reservation you agree to our <%= link_to 'privacy policy', 'https://www.stacey.de/datenschutz' %></p>
          </div>
          <div class="buttons">
            <div id='overlay-button'></div>
            <button class="payment-button" disabled="true">Complete Reservation & Process Payment</button>
          </div>
        <% end %>
      </div>
    </div>
    <div class="calculation-container">
      <div class="header">
        <div class="secure-payment-wrapper">
          <div class="secure-payment-header">
            <i class="fas fa-lock"></i>
            <p>SecurePayment</p>
          </div>
          <div class="icons">
            <i class="fab fa-cc-amex"></i>
            <i class="fab fa-cc-visa"></i>
            <i class="fab fa-cc-mastercard"></i>
          </div>
        </div>
      </div>
      <div class="payment-section">
        <h2 class="payment-sections-header">Booking Summary</h2>
        <p class="summary-items-header"><%= @room.art_of_room %></p>
        <div class="summary-item">
          <p>Duration of your stay</p>
          <p><%= @applicant.duration_of_stay %></p>
        </div>
        <div class="summary-item">
          <p>Move-in</p>
          <p><%= @applicant.move_in_date.strftime('%d.%m.%Y') %></p>
        </div>
        <div class="summary-item">
          <p>Move-out</p>
          <p><%= (@applicant.move_in_date + @applicant.duration_of_stay[0].to_i.months - 1.day).strftime('%d.%m.%Y') %></p>
        </div>
        <div class="line"></div>
        <div class="total-payment">
          <p class="summary-items-header">TOTAL YOU'LL PAY</p>
          <div class="summary-item">
            <p>Room Price per Month</p>
            <p><%= @amount_per_month %> €</p>
          </div>
          <div class="summary-item">
            <p>Deposit</p>
            <p><%= @deposit %> €</p>
          </div>
          <div class="summary-item">
            <p>Booking Fee</p>
            <p>80 €</p>
          </div>
          <div class="total summary-item">
            <div class="line"></div>
            <div class="d-flex">
              <p>Total Today</p>
              <p><%= @total_amount %> €</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <h1>Purchase of teddy <%= @booking.room.art_of_room %></h1> -->
<%#= form_tag booking_payments_path(@booking) do %>
<!--   <article>
    <label class="amount">
      <span>Amount: <%= @amount %></span>
      <span>Deposit: <%= @deposit %></span>
    </label>
  </article> -->

  <!-- Commented for the lecture, remove comments. -->
<!--   <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    data-key="<%#= Rails.configuration.stripe[:publishable_key] %>"
    data-name="My Room"
    data-email="<%= current_user.email %>"
    data-description="Room <%= @booking.room.art_of_room %>"
    data-amount="<%= @amount %>"
    data-currency="EUR"></script> -->

    <%# end %>

<!-- <form id="payment-form" method="POST" action="/bookings">
        <p class="instruction">Complete your shipping and payment details below</p>
        <section>
          <h2>Shipping &amp; Billing Information</h2>
          <fieldset class="with-state">
            <label>
              <span>Name</span>
              <input name="name" class="field" placeholder="Jenny Rosen" required>
            </label>
            <label>
              <span>Email</span>
              <input name="email" type="email" class="field" placeholder="jenny@example.com" required>
            </label>
            <label>
              <span>Address</span>
              <input name="address" class="field" placeholder="185 Berry Street Suite 550">
            </label>
            <label>
              <span>City</span>
              <input name="city" class="field" placeholder="San Francisco">
            </label>
            <label class="state">
              <span>State</span>
              <input name="state" class="field" placeholder="CA">
            </label>
            <label class="zip">
              <span>ZIP</span>
              <input name="postal_code" class="field" placeholder="94107">
            </label>
            <label class="select">
              <span>Country</span>
              <div id="country" class="field US">
                <select name="country">
                  <option value="AU">Australia</option>
                  <option value="AT">Austria</option>
                  <option value="BE">Belgium</option>
                  <option value="BR">Brazil</option>
                  <option value="CA">Canada</option>
                  <option value="CN">China</option>
                  <option value="DK">Denmark</option>
                  <option value="FI">Finland</option>
                  <option value="FR">France</option>
                  <option value="DE">Germany</option>
                  <option value="HK">Hong Kong</option>
                  <option value="IE">Ireland</option>
                  <option value="IT">Italy</option>
                  <option value="JP">Japan</option>
                  <option value="LU">Luxembourg</option>
                  <option value="MX">Mexico</option>
                  <option value="NL">Netherlands</option>
                  <option value="NZ">New Zealand</option>
                  <option value="NO">Norway</option>
                  <option value="PT">Portugal</option>
                  <option value="SG">Singapore</option>
                  <option value="ES">Spain</option>
                  <option value="SE">Sweden</option>
                  <option value="CH">Switzerland</option>
                  <option value="GB">United Kingdom</option>
                  <option value="US" selected="selected">United States</option>
                </select>
              </div>
            </label>
          </fieldset>
          <p class="tip">Select another country to see different payment options.</p>
        </section>
        <section>
          <h2>Payment Information</h2>
          <nav id="payment-methods">
            <ul>
              <li>
                <input type="radio" name="payment" id="payment-card" value="card" checked>
                <label for="payment-card">Card</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-ach_credit_transfer" value="ach_credit_transfer" checked>
                <label for="payment-ach_credit_transfer">Bank Transfer</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-alipay" value="alipay">
                <label for="payment-alipay">Alipay</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-bancontact" value="bancontact">
                <label for="payment-bancontact">Bancontact</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-eps" value="eps">
                <label for="payment-eps">EPS</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-ideal" value="ideal">
                <label for="payment-ideal">iDEAL</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-giropay" value="giropay">
                <label for="payment-giropay">Giropay</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-multibanco" value="multibanco">
                <label for="payment-multibanco">Multibanco</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-sepa_debit" value="sepa_debit">
                <label for="payment-sepa_debit">SEPA Direct Debit</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-sofort" value="sofort">
                <label for="payment-sofort">SOFORT</label>
              </li>
              <li>
                <input type="radio" name="payment" id="payment-wechat" value="wechat">
                <label for="payment-wechat">WeChat Pay</label>
              </li>
            </ul>
          </nav>
          <div class="payment-info card visible">
            <fieldset>
              <label>
                <span>Card</span>
                <div id="card-element" class="field"></div>
              </label>
            </fieldset>
          </div>
          <div class="payment-info sepa_debit">
            <fieldset>
              <label>
                <span>IBAN</span>
                <div id="iban-element" class="field"></div>
              </label>
            </fieldset>
            <p class="notice">By providing your IBAN and confirming this payment, you’re authorizing Payments Demo and Stripe, our payment
              provider, to send instructions to your bank to debit your account. You’re entitled to a refund under the terms
              and conditions of your agreement with your bank.</p>
          </div>
          <div class="payment-info ideal">
            <fieldset>
              <label>
                <span>iDEAL Bank</span>
                <div id="ideal-bank-element" class="field"></div>
              </label>
            </fieldset>
          </div>
          <div class="payment-info redirect">
            <p class="notice">You’ll be redirected to the banking site to complete your payment.</p>
          </div>
          <div class="payment-info receiver">
            <p class="notice">Payment information will be provided after you place the order.</p>
          </div>
          <div class="payment-info wechat">
            <div id="wechat-qrcode"></div>
            <p class="notice">Click the button below to generate a QR code for WeChat.</p>
          </div>
        </section>
        <button type="submit">Pay</button>
      </form>
    -->
